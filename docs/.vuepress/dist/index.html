<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Amazee Silverback | Silverback</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/assets/css/0.styles.b730d4bd.css" as="style"><link rel="preload" href="/assets/js/app.6fe9dec9.js" as="script"><link rel="preload" href="/assets/js/4.59f547e1.js" as="script"><link rel="prefetch" href="/assets/js/2.e6b85e1a.js"><link rel="prefetch" href="/assets/js/3.39d06fcd.js"><link rel="prefetch" href="/assets/js/5.de9629df.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b730d4bd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">Silverback</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link router-link-exact-active router-link-active">Home</a></div><div class="nav-item"><a href="/delivery/" class="nav-link">Delivery</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link router-link-exact-active router-link-active">Home</a></div><div class="nav-item"><a href="/delivery/" class="nav-link">Delivery</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Amazee Silverback</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/#installation" class="sidebar-link">Installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/#project-initialisation" class="sidebar-link">Project initialisation</a></li><li class="sidebar-sub-header"><a href="/#updating" class="sidebar-link">Updating</a></li><li class="sidebar-sub-header"><a href="/#running-the-website-locally" class="sidebar-link">Running the website locally</a></li></ul></li><li><a href="/#testing" class="sidebar-link">Testing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#test-content" class="sidebar-link">Test content</a></li><li class="sidebar-sub-header"><a href="/#running-tests" class="sidebar-link">Running tests</a></li><li class="sidebar-sub-header"><a href="/#writing-tests" class="sidebar-link">Writing tests</a></li></ul></li><li><a href="/#development-workflow" class="sidebar-link">Development workflow</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/#lagoon" class="sidebar-link">Lagoon</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#drush-aliases" class="sidebar-link">Drush aliases</a></li></ul></li><li><a href="/#webpack" class="sidebar-link">Webpack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/#known-issues" class="sidebar-link">Known issues</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><p><a href="https://travis-ci.com/AmazeeLabs/silverback" target="_blank" rel="noopener noreferrer"><img src="https://travis-ci.com/AmazeeLabs/silverback.svg?branch=master" alt="Build Status"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h1 id="amazee-silverback"><a href="#amazee-silverback" aria-hidden="true" class="header-anchor">#</a> Amazee Silverback</h1> <p><code>amazee/silverback</code> is a composer package adding common project dependencies, tooling and configuration scaffolding to Amazee Drupal projects. It aims to improve product quality and reduce maintenance costs by encouraging three simple principles:</p> <ol><li><strong>Maximize open source:</strong> Lower initial costs, technical debt and maintenance costs by using and contributing to open source code as much as possible. For every feature required by a project that is not solvable by configuration or theming, try to find a generic solution that can be contributed and added as a dependency to <code>amazeelabs/silverback</code>.</li> <li><strong>Minimize requirements:</strong> It has to be as easy as possible to work on a project. If you need the production database and a local elasticsearch cluster to edit CSS files, you are doing microservices terribly wrong. <em>Example:</em> By default silverback development sites run on SQLite. MySQL is considered a performance optimization, and it's not in the projects scope to test Drupal's database abstraction layer.</li> <li><strong>Testability first:</strong> A project has to be fully testable with only the git repository at any time. All required assets (test content, media, configuration) have to be set up during the installation process. It <strong>must not</strong> rely on production data. Every feature and bug fix has to bring a test case that can be reproduced. It might take more time initially, but it will pay off.</li></ol> <h2 id="installation"><a href="#installation" aria-hidden="true" class="header-anchor">#</a> Installation</h2> <h3 id="prerequisites"><a href="#prerequisites" aria-hidden="true" class="header-anchor">#</a> Prerequisites</h3> <p>To create or work on a Silverback project the following tools have to be available on your system:</p> <ul><li>A <a href="http://php.net/manual/en/install.php" target="_blank" rel="noopener noreferrer">PHP 7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> interpreter meeting <a href="https://www.drupal.org/docs/8/system-requirements/php-requirements" target="_blank" rel="noopener noreferrer">Drupal requirements<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Installed and configured <a href="https://direnv.net/" target="_blank" rel="noopener noreferrer">direnv<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (don't forget about the <a href="https://direnv.net/index.html#setup" target="_blank" rel="noopener noreferrer">setup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for your shell)</li> <li>Globally installed <a href="https://getcomposer.org/" target="_blank" rel="noopener noreferrer">composer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><em>Optional:</em> A bitcoin miner to give the other three processor cores a purpose, since they are not consumed by docker any more.</li></ul> <h3 id="project-initialisation"><a href="#project-initialisation" aria-hidden="true" class="header-anchor">#</a> Project initialisation</h3> <p>Given you already created a composer based Drupal project like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>composer create-project drupal-composer/drupal-project:8.x-dev my-project --no-interaction
</code></pre></div><p>You just have to require the <code>amazeelabs/silverback</code> composer package and initialise it:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> my-project
composer remove drupal/core
composer require amazeelabs/silverback
./vendor/bin/silverback init
yarn
</code></pre></div><p>If you've set up <code>direnv</code> correctly, it will complain at this point that there is an unknown <code>.envrc</code> file. Just execute <code>direnv allow</code> to enable it. From now own environment variables and executable search paths will be set automatically whenever you enter this directory. Here is how it should look in case of a correct installation:</p> <div class="language- extra-class"><pre class="language-text"><code>me@local:~/Projects $ cd my-project/
direnv: error .envrc is blocked. Run `direnv allow` to approve its content.
me@local:~/Projects/my-project $ direnv allow
direnv: loading .envrc
direnv: export +CYPRESS_BASE_URL ... +SB_TEST_CONTENT ~PATH
me@local:~/Projects/my-project $ cd ..
direnv: unloading
me@local:~/Projects $ cd my-project/
direnv: loading .envrc
direnv: export +CYPRESS_BASE_URL ... +SB_TEST_CONTENT ~PATH
</code></pre></div><p>Requiring and initating the package did a couple of things:</p> <ul><li>A list of common project dependencies have been installed.</li> <li>Configuration files for Travis, Lando and amazee.io have been created.</li> <li>Your composer.json has been slightly modified.</li> <li>An environment-based <code>settings.php</code> has been placed in <code>web/sites/default</code>.</li> <li>A <code>tests</code> directory with a fully operational <a href="https://www.cypress.io" target="_blank" rel="noopener noreferrer">Cypress<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> setup appeared.</li> <li>A <code>.env</code> file was initialised that you can use to configure your local environment.</li></ul> <h3 id="updating"><a href="#updating" aria-hidden="true" class="header-anchor">#</a> Updating</h3> <p>To update Silverback along with its dependencies simply update the composer package:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>composer upgrade amazeelabs/silverback --with-dependencies
</code></pre></div><p>This will also trigger an update hook that re-runs <code>silverback init</code>. If you removed the update hook, you'll have to do that yourself. This will overwrite all the scaffolded files to get in any updates. You can just use git to select which updates you want and which not.</p> <h3 id="running-the-website-locally"><a href="#running-the-website-locally" aria-hidden="true" class="header-anchor">#</a> Running the website locally</h3> <p>To run the project locally, just execute the setup procedure and start a local development server:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>silverback setup
drush serve
</code></pre></div><p>Now your Drupal installation should be accessible at http://localhost:8888. Admin account credentials can be configured in your <code>.env</code> file.</p> <p>Another invocation of <code>silverback setup</code> will scratch the current install and and create a new one. <code>silverback teardown</code> will just do the <em>scratch</em> part. Running <code>silverback setup --backup</code> will create a backup before removing the current install, and <code>silverback teardown --restore</code> will bring the latest backup back. These two commands are mainly used by the end to end testing processes to spin up test sites (<em>TODO: Move test sites to simpletest subsites</em>).</p> <p><strong>Danger:</strong> Currently, there can be only <em><strong>one</strong></em> backup.</p> <h2 id="testing"><a href="#testing" aria-hidden="true" class="header-anchor">#</a> Testing</h2> <h3 id="test-content"><a href="#test-content" aria-hidden="true" class="header-anchor">#</a> Test content</h3> <p>Silverback assumes that production databases are somewhat confidential and copying them all over the place might be a major security risk. So, no database syncing. Every new feature should provide illustrative test content by including a <em>test content module</em>, that contains <a href="https://www.drupal.org/project/default_content" target="_blank" rel="noopener noreferrer"><code>default_content</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> exports or install hooks to create reproducible and testable content.</p> <blockquote><p>After <code>silverback setup</code> a project has to be fully operational and testable.</p></blockquote> <p><em><strong>TODO:</strong> More detailed instructions for providing default content.</em></p> <h3 id="running-tests"><a href="#running-tests" aria-hidden="true" class="header-anchor">#</a> Running tests</h3> <p>There are two levels of testing which will be executed by the <a href="http://travis-ci.org" target="_blank" rel="noopener noreferrer">Travis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> configuration added by <code>silverback init</code>.</p> <p>Custom modules are tested with <a href="https://www.drupal.org/docs/8/testing" target="_blank" rel="noopener noreferrer">Drupal's standard testing frameworks<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. <a href="http://travis-ci.org" target="_blank" rel="noopener noreferrer">Travis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> will execute all Drupal tests in <code>web/modules/custom</code>.</p> <p>For end to end testing, a <a href="https://www.cypress.io" target="_blank" rel="noopener noreferrer">Cypress<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> configuration is provided in the <code>tests</code> folder. <code>silverback init</code> should have added some basic tests that you can run immediately.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> tests
<span class="token function">npm</span> <span class="token function">install</span>
cypress run
</code></pre></div><p>This should run the tests in a headless browser. To run them interactively and automatically, execute <code>cypress open</code>, which will bring up the cypress interface. For more information on cypress options, please have a look at the <a href="https://docs.cypress.io/guides/guides/command-line.html" target="_blank" rel="noopener noreferrer">Cypress CLI documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="writing-tests"><a href="#writing-tests" aria-hidden="true" class="header-anchor">#</a> Writing tests</h3> <h4 id="simple-javascript-tests"><a href="#simple-javascript-tests" aria-hidden="true" class="header-anchor">#</a> Simple javascript tests</h4> <p>You can learn how to write standard javascript tests from the <a href="https://docs.cypress.io/guides/getting-started/writing-your-first-test.html#Add-a-test-file" target="_blank" rel="noopener noreferrer">Cypress documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h4 id="behavioral-testing"><a href="#behavioral-testing" aria-hidden="true" class="header-anchor">#</a> Behavioral testing</h4> <p>The preferred way for writing tests is to use <a href="https://docs.cucumber.io/gherkin/reference/" target="_blank" rel="noopener noreferrer">Gherkin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to provide a specification of your feature <em><strong>before</strong></em> implementing it, and then adding step definitions to actually test your application.</p> <p>One general misconception about behavior testing is to think it is there so you don't have to write test code but just <em>&quot;plain English&quot;</em>. <em>But that's not true!</em> As a side effect, you <em>might</em> be able to reuse some step definitions here and there, but the main goal is to create digestable feature definitions that all stakeholders can understand and participate on.</p> <p>There is a lot of literature on writing good test specifications:</p> <ul><li><a href="http://aslakhellesoy.com/post/11055981222/the-training-wheels-came-off" target="_blank" rel="noopener noreferrer">How the training wheels came off<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> by Aslak Helles√∏y</li> <li><a href="https://cucumber.io/blog" target="_blank" rel="noopener noreferrer">The cucumber.io blog<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://soundcloud.com/cucumber-podcast" target="_blank" rel="noopener noreferrer">The cucumber podcast<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Silverback comes with a simple example that tests the administration login:</p> <div class="language-gherkin extra-class"><pre class="language-gherkin"><code><span class="token feature"><span class="token keyword">Feature:</span><span class="token important"> Login</span>

  Basic Drupal site setup and administration login.

</span>  <span class="token scenario"><span class="token keyword">Background:</span><span class="token important"></span></span>
    Initial site setup with working administration login.

  <span class="token tag">@Silverback</span> <span class="token tag">@COMPLETED</span>
  <span class="token scenario"><span class="token keyword">Scenario:</span><span class="token important"> Valid Login</span></span>
    <span class="token atrule">Given</span> I am on the login screen
    <span class="token atrule">And</span> I use the administration credentials to log in
    <span class="token atrule">Then</span> I should see the administration toolbar
</code></pre></div><p>This feature specification lives in any subfolder of <code>tests/cypress/integration</code>, where you can also find the full example of the login feature.
The tags the scenarios are annotated with allow to control <em>which</em> tests are executed. The travis configuration will by default only execute tests that are tagged with <code>@COMPLETED</code>, So feature definitions can be added and worked on without breaking tests.</p> <p>The corresponding step definitions look like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/* global Given, When, Then */</span>

<span class="token keyword">const</span> <span class="token function-variable function">login</span> <span class="token operator">=</span> <span class="token punctuation">(</span>user<span class="token punctuation">,</span> pass<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  cy<span class="token punctuation">.</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token string">'/user/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  cy<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'#edit-name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  cy<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'#edit-pass'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>pass<span class="token punctuation">)</span><span class="token punctuation">;</span>
  cy<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'#edit-submit'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">'Log in'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">Given</span><span class="token punctuation">(</span><span class="token regex">/^I am on the login screen$/</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  cy<span class="token punctuation">.</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token string">'/user/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">When</span><span class="token punctuation">(</span><span class="token regex">/^I use the administration credentials to log in$/</span><span class="token punctuation">,</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">Then</span><span class="token punctuation">(</span><span class="token regex">/^I should see the administration toolbar$/</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  cy<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'#toolbar-bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>We use <a href="https://cucumber.io/" target="_blank" rel="noopener noreferrer">cucumber.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and regular expressions to map readable step definitions to actual step implementations in javascript. Within these steps, you can use all <a href="http://docs.cypress.io" target="_blank" rel="noopener noreferrer">cypress commands and extensions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <blockquote><p>Every scenario has to be isolated, and must not depend on execution of a previous scenario. Silverback contains hooks that will run <code>silverback setup</code> and <code>silverback teardown</code> at the beginning and end of every scenario to enforce that.</p></blockquote> <h4 id="jira-integration"><a href="#jira-integration" aria-hidden="true" class="header-anchor">#</a> Jira integration</h4> <p>You can use the <a href="https://marketplace.atlassian.com/apps/1211664/behave-pro-for-bdd-jira-git-cucumber?hosting=cloud&tab=overview" target="_blank" rel="noopener noreferrer">Behave Pro<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> extension for Jira to maintain and discuss your specifications right alongside your tickets, which is a great way to make them more visible to all the stakeholders that understand <em>git</em> as an insult.</p> <p>Silverback comes with a <code>silverback download-tests</code> command that will pull all feature specifications for a project. To enable it, you just have to add some variables to the <code>.env</code> file at the root of the project:</p> <ul><li><code>SB_JIRA_HOST</code>: The domain name of the Jira instance.</li> <li><code>SB_JIRA_USER</code>: The Jira user account.</li> <li><code>SB_JIRA_PASS</code>: The Jira account password.</li> <li><code>SB_JIRA_PROJECTS</code>: A space separated list of Jira projects as <code>[shortcut]:[project id]</code> pairs. For example: <code>PROJ:12345</code>. To get your Jira project ID you might have to consult the instance' administrator.</li></ul> <p>Tests are downloaded to project specific subfolders of <code>tests/cypress/integration</code>, (e.g. <code>tests/cypress/integration/PROJ</code>) and <em>should not be added to the git repsitory</em>, since they may change outside of the development workflow.</p> <p>Scenarios downloaded from Jira will automatically be tagged based on their ticket, assignee and workflow state. Scenarios of tickets that are in progress are marked as <code>@WIP</code> while everything that is considered <em>done</em> has the tag <code>@COMPLETED</code>. Thats how the <a href="http://travis-ci.org" target="_blank" rel="noopener noreferrer">Travis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> configuration will only execute tests that are actually worth executing. For local development it might make sense to set the <code>CYPRESS_TAGS</code> environment variable to <code>@assignee:my-jira-name and @WIP</code> to only run tests for tickets that are assigned to oneself and currently in progress. It is also possible to add custom tags to scenarios in Jira.</p> <p><strong>Note:</strong> The cucumber implementation currently only takes tags on scenarios into account. <a href="https://marketplace.atlassian.com/apps/1211664/behave-pro-for-bdd-jira-git-cucumber?hosting=cloud&tab=overview" target="_blank" rel="noopener noreferrer">Behave Pro<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> also allows to tag whole features, but these are ignored by the test runner (TODO: fix it in https://github.com/TheBrainFamily/cypress-cucumber-preprocessor).</p> <h2 id="development-workflow"><a href="#development-workflow" aria-hidden="true" class="header-anchor">#</a> Development workflow</h2> <p>To get the most out of (and in to) <code>amazeelabs/silverback</code>, the development process should follow a common pattern:</p> <ol><li>Review feature/bug request</li> <li>Create the project level feature specification</li> <li>Investigate which parts are not doable by just configuring and/or theming existing components.</li> <li>Try to find a reusable, generic solution (e.g. Views/Rules/Block/GraphQL plugins).</li> <li>Create a pull request against <code>amazeelabs/silverback</code> with the proposed changes/additions. It should contain:
<ul><li>The code/dependency changes themselves.</li> <li>New or modified feature specifications in <code>assets/tests/cypress/integration/silverback</code>.</li> <li>New or modified documentation pages in <code>docs</code> (<strong>TODO:</strong> use https://docusaurus.io/?).</li> <li>Example configuration in <code>config</code>.</li></ul></li> <li>Apply the pull request as a patch in your projects <code>composer.json</code>.</li> <li>If there are dependency changes, you have to add them temporarily to your project's
<code>composer.json</code>. Composer patches can't affect dependencies since they are collecteded before patches are applied.</li></ol> <h2 id="lagoon"><a href="#lagoon" aria-hidden="true" class="header-anchor">#</a> Lagoon</h2> <p>The project is ready to be used with amazeeio local development flow. Just install <a href="https://docs.amazee.io/local_docker_development/pygmy.html" target="_blank" rel="noopener noreferrer">Pygmy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, run <code>docker-compose up -d</code> and the site is ready to be installed.</p> <h3 id="drush-aliases"><a href="#drush-aliases" aria-hidden="true" class="header-anchor">#</a> Drush aliases</h3> <p>Lagoon doesn't yet support just-in-time fetching of site aliases for drush 9. Please refer to <a href="https://lagoon.readthedocs.io/en/latest/using_lagoon/drupal/drush9/" target="_blank" rel="noopener noreferrer">the docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for a work-around.</p> <h2 id="webpack"><a href="#webpack" aria-hidden="true" class="header-anchor">#</a> Webpack</h2> <p>The project is set up to use webpack to bundle drupal libraries, so they can be written in modern javascript and import packages from npm. Setup:</p> <ul><li><code>drush en -y webpack_babel</code> (there's webpack_react too if you need react)</li> <li><code>yarn webpack-dev</code> - starts the local webpack dev server. This needs to be on all the time during development, so the libraries are built. If you don't want to change anything, but have the libraries working, run <code>drush webpack:build</code>.</li></ul> <h3 id="known-issues"><a href="#known-issues" aria-hidden="true" class="header-anchor">#</a> Known issues</h3> <ul><li>In case of javascript errors, first try disabling the aggregation at <em>/admin/config/development/performance</em>.</li> <li>Only one <code>yarn webpack-dev</code> can be running at any given point in time.</li></ul></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.6fe9dec9.js" defer></script><script src="/assets/js/4.59f547e1.js" defer></script>
  </body>
</html>
